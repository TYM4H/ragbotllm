ToDo
I. Архитектура и хранение данных

Реализовать систему ограничений на объём хранилища ChromaDB для каждого пользователя.

Добавить хранение метаданных о документах (имя файла, дата загрузки, количество страниц, длина текста).

Внедрить проверку хэша загружаемого PDF для предотвращения повторной индексации идентичных файлов.

II. Обработка текста и эмбеддинги

Реализовать безопасное разбиение документа на крупные фрагменты при превышении лимита контекста модели.

Добавить кэширование эмбеддингов для исключения повторных обращений к Ollama при одинаковом тексте.

Обеспечить поддержку выбора модели для эмбеддингов и генерации ответов (через настройки или переменные окружения).

III. Backend и API

Реализовать обработку исключений и возвращение корректных кодов HTTP-ответов (400, 404, 500).

Добавить API-методы для управления документами:

GET /list_docs — получение списка документов пользователя;

DELETE /doc/{id} — удаление выбранного документа;

DELETE /reset/{user_id} — очистка коллекции пользователя.

Добавить простую авторизацию через API-ключ, определяемый в файле .env.

IV. Telegram-бот

Внедрить управление состояниями пользователя (FSM) для разделения сценариев загрузки и запросов.

Реализовать уведомления о ходе индексации документа (сообщения «Идёт обработка…» / «Готово»).

Добавить команды:

/docs — список загруженных документов;

/delete <имя> — удаление документа;

/reset — очистка коллекции;

/help — справка по использованию.

V. Производительность и устойчивость

Вынести индексацию PDF в отдельный поток или процесс для предотвращения блокировки FastAPI.

Ввести ограничение на количество одновременных запросов к Ollama и реализацию очереди задач.

Перейти на PyMuPDF (fitz) для повышения точности извлечения текста из PDF-документов.

VI. Деплой и эксплуатация

Подготовить Dockerfile и docker-compose.yml для сборки и запуска следующих сервисов:

backend (FastAPI);

ollama;

chroma.

Добавить систему логирования (ротация логов, вывод в файл).

Реализовать сбор базовых метрик производительности и обращений (через middleware FastAPI).
